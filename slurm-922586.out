begin_raw_vgg_encoder_features
/home/by783/myenv/lib/python3.6/site-packages/torch/serialization.py:425: SourceChangeWarning: source code of class '__main__.Model_Based_Autoencoder' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
PyTorch Version:  0.4.1
Torchvision Version:  0.2.2
PyTorch Version: 0.4.1Torchvision Version: GPU modeBegin to load data...
Begin to load data...
sup_train_data.class_to_idx==sup_val_data.class_to_idx:  True
Params to learn:
	module.classifier.0.weight
	module.classifier.0.bias
	module.classifier.3.weight
	module.classifier.3.bias
	module.classifier.6.weight
	module.classifier.6.bias
Begin to train...
Epoch 0/49
----------
train Loss: 6.9118 Acc: 0.0009
training time: 1574s
val Loss: 6.9073 Acc: 0.0013
training time: 3078s

Epoch 1/49
----------
train Loss: 6.9103 Acc: 0.0012
training time: 4357s
val Loss: 6.9061 Acc: 0.0011
training time: 5866s

Epoch 2/49
----------
train Loss: 6.9081 Acc: 0.0011
training time: 7477s
val Loss: 6.9049 Acc: 0.0013
training time: 8858s

Epoch 3/49
----------
train Loss: 6.9066 Acc: 0.0013
training time: 10625s
val Loss: 6.9038 Acc: 0.0013
training time: 12448s

Epoch 4/49
----------
train Loss: 6.9059 Acc: 0.0013
training time: 14169s
val Loss: 6.9028 Acc: 0.0014
training time: 15688s

Epoch 5/49
----------
train Loss: 6.9040 Acc: 0.0015
training time: 17468s
val Loss: 6.9017 Acc: 0.0018
training time: 19233s

Epoch 6/49
----------
train Loss: 6.9027 Acc: 0.0014
training time: 21190s
val Loss: 6.9006 Acc: 0.0019
training time: 23165s

Epoch 7/49
----------
train Loss: 6.9015 Acc: 0.0013
training time: 25130s
val Loss: 6.8995 Acc: 0.0021
training time: 26748s

Epoch 8/49
----------
train Loss: 6.9003 Acc: 0.0015
training time: 28545s
val Loss: 6.8982 Acc: 0.0023
training time: 30081s

Epoch 9/49
----------
train Loss: 6.8988 Acc: 0.0015
training time: 31686s
val Loss: 6.8969 Acc: 0.0027
training time: 33172s

Epoch 10/49
----------
train Loss: 6.8973 Acc: 0.0016
training time: 34740s
val Loss: 6.8954 Acc: 0.0030
training time: 36258s

Epoch 11/49
----------
train Loss: 6.8955 Acc: 0.0021
training time: 37853s
val Loss: 6.8937 Acc: 0.0034
training time: 39339s

Epoch 12/49
----------
train Loss: 6.8942 Acc: 0.0019
training time: 41018s
val Loss: 6.8917 Acc: 0.0041
training time: 43142s

Epoch 13/49
----------
train Loss: 6.8923 Acc: 0.0021
training time: 45523s
val Loss: 6.8898 Acc: 0.0045
training time: 47372s

Epoch 14/49
----------
train Loss: 6.8900 Acc: 0.0025
training time: 49118s
val Loss: 6.8873 Acc: 0.0050
training time: 50591s

Epoch 15/49
----------
train Loss: 6.8875 Acc: 0.0027
training time: 52130s
val Loss: 6.8846 Acc: 0.0048
training time: 53552s

Epoch 16/49
----------
train Loss: 6.8841 Acc: 0.0029
training time: 54987s
val Loss: 6.8814 Acc: 0.0049
training time: 56350s

Epoch 17/49
----------
train Loss: 6.8809 Acc: 0.0027
training time: 57751s
val Loss: 6.8778 Acc: 0.0049
training time: 59126s

Epoch 18/49
----------
train Loss: 6.8779 Acc: 0.0030
training time: 60506s
val Loss: 6.8736 Acc: 0.0049
training time: 61828s

Epoch 19/49
----------
train Loss: 6.8735 Acc: 0.0033
training time: 63157s
val Loss: 6.8689 Acc: 0.0047
training time: 64522s

Epoch 20/49
----------
train Loss: 6.8686 Acc: 0.0033
training time: 65875s
val Loss: 6.8631 Acc: 0.0045
training time: 67193s

Epoch 21/49
----------
train Loss: 6.8634 Acc: 0.0034
training time: 68576s
val Loss: 6.8568 Acc: 0.0044
training time: 69928s

Epoch 22/49
----------
train Loss: 6.8560 Acc: 0.0037
training time: 71313s
val Loss: 6.8493 Acc: 0.0041
training time: 72674s

Epoch 23/49
----------
train Loss: 6.8496 Acc: 0.0035
training time: 74108s
val Loss: 6.8411 Acc: 0.0041
training time: 75488s

Epoch 24/49
----------
train Loss: 6.8400 Acc: 0.0041
training time: 76890s
val Loss: 6.8317 Acc: 0.0039
training time: 78207s

Epoch 25/49
----------
train Loss: 6.8315 Acc: 0.0036
training time: 79577s
val Loss: 6.8216 Acc: 0.0039
training time: 80894s

Epoch 26/49
----------
train Loss: 6.8204 Acc: 0.0036
training time: 82245s
val Loss: 6.8098 Acc: 0.0039
training time: 83557s

Epoch 27/49
----------
train Loss: 6.8099 Acc: 0.0039
training time: 84991s
val Loss: 6.7987 Acc: 0.0037
training time: 86438s

Epoch 28/49
----------
train Loss: 6.7986 Acc: 0.0036
training time: 87785s
val Loss: 6.7870 Acc: 0.0037
training time: 89090s

Epoch 29/49
----------
train Loss: 6.7871 Acc: 0.0035
training time: 90494s
val Loss: 6.7753 Acc: 0.0041
training time: 91813s

Epoch 30/49
----------
train Loss: 6.7759 Acc: 0.0039
training time: 93197s
val Loss: 6.7653 Acc: 0.0044
training time: 94588s

Epoch 31/49
----------
train Loss: 6.7662 Acc: 0.0035
training time: 96056s
val Loss: 6.7545 Acc: 0.0053
training time: 97443s

Epoch 32/49
----------
train Loss: 6.7562 Acc: 0.0039
training time: 98896s
val Loss: 6.7450 Acc: 0.0052
training time: 100316s

Epoch 33/49
----------
train Loss: 6.7473 Acc: 0.0038
training time: 101688s
val Loss: 6.7365 Acc: 0.0063
training time: 103064s

Epoch 34/49
----------
train Loss: 6.7383 Acc: 0.0043
training time: 104534s
val Loss: 6.7276 Acc: 0.0071
training time: 105909s

Epoch 35/49
----------
train Loss: 6.7322 Acc: 0.0052
training time: 107399s
val Loss: 6.7197 Acc: 0.0077
training time: 108935s

Epoch 36/49
----------
train Loss: 6.7218 Acc: 0.0046
training time: 110407s
val Loss: 6.7113 Acc: 0.0081
training time: 111803s

Epoch 37/49
----------
train Loss: 6.7129 Acc: 0.0049
training time: 113198s
val Loss: 6.7029 Acc: 0.0083
training time: 114652s

Epoch 38/49
----------
train Loss: 6.7048 Acc: 0.0052
training time: 116262s
val Loss: 6.6943 Acc: 0.0088
training time: 117761s

Epoch 39/49
----------
train Loss: 6.6970 Acc: 0.0060
training time: 119312s
val Loss: 6.6853 Acc: 0.0090
training time: 120848s

Epoch 40/49
----------
train Loss: 6.6868 Acc: 0.0060
training time: 122471s
val Loss: 6.6761 Acc: 0.0093
training time: 124048s

Epoch 41/49
----------
train Loss: 6.6785 Acc: 0.0063
training time: 125661s
val Loss: 6.6661 Acc: 0.0093
training time: 127211s

Epoch 42/49
----------
train Loss: 6.6677 Acc: 0.0066
training time: 128737s
val Loss: 6.6562 Acc: 0.0099
training time: 130258s

Epoch 43/49
----------
train Loss: 6.6573 Acc: 0.0066
training time: 131729s
val Loss: 6.6443 Acc: 0.0105
training time: 133157s

Epoch 44/49
----------
train Loss: 6.6469 Acc: 0.0074
training time: 134621s
val Loss: 6.6332 Acc: 0.0102
training time: 136066s

Epoch 45/49
----------
train Loss: 6.6341 Acc: 0.0080
training time: 137582s
val Loss: 6.6204 Acc: 0.0109
training time: 139073s

Epoch 46/49
----------
train Loss: 6.6194 Acc: 0.0081
training time: 140530s
val Loss: 6.6064 Acc: 0.0116
training time: 141986s

Epoch 47/49
----------
train Loss: 6.6085 Acc: 0.0083
training time: 143464s
val Loss: 6.5917 Acc: 0.0124
training time: 144897s

Epoch 48/49
----------
train Loss: 6.5933 Acc: 0.0092
training time: 146381s
val Loss: 6.5758 Acc: 0.0123
training time: 147892s

Epoch 49/49
----------
train Loss: 6.5770 Acc: 0.0098
training time: 149436s
val Loss: 6.5611 Acc: 0.0124
training time: 150918s

Training complete in 2515m 18s
Best val Acc: 0.012438
Traceback (most recent call last):
  File "190427_main_vgg_encoder_feature.py", line 357, in <module>
    model_ft, hist = train_model(model_ft, dataloaders, criterion, optimizer_ft, num_epochs=num_epochs, is_inception=(model_name=="inception"))
  File "190427_main_vgg_encoder_feature.py", line 297, in train_model
    model.load_state_dict(best_model_wts)
NameError: name 'best_model_wts' is not defined
slurmstepd: error: The SLURM utilizes Linux cgroups for resource containment. For reference please read the explanation in the bug report: https://bugs.schedmd.com/show_bug.cgi?id=3214#c4
slurmstepd: error: The SLURM utilizes Linux cgroups for resource containment. For reference please read the explanation in the bug report: https://bugs.schedmd.com/show_bug.cgi?id=3214#c4
